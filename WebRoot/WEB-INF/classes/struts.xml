<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 2.1//EN" "http://struts.apache.org/dtds/struts-2.1.dtd">
<struts>
	<!-- 配置Struts中的Action动作类全部由Spring框架托管 -->
	<constant name="objectFactory" value="spring"></constant>
	
	<!-- 配置Struts中的参数传递乱码解决方案 -->
	<constant name="struts.i18n.encoding" value="utf-8"></constant>
	
	<!-- Struts中的action程序包 -->
	<package name="actions" extends="struts-default" namespace="/">
		<!-- 全局的Result配置 -->
		<global-results>
			<result name="login">/userManage/logIn.jsp</result>
		</global-results>
		
		<!-- Interceptor 监听器 的注册-->
		
		<!-- Action动作类的注册 -->
		
		<!-- 与书籍有关的动作类的注册 -->
		<!-- 需要的参数:bookid ,放入sesssion里的值为bookDetail book实体类-->
		<action name="bookDetail" class="findBookByIdAction">
		  <result type="redirect" name="success">/book/bookDetail.jsp</result>
		  <result name="notFound" >/error.jsp</result>
		</action>
		
		<action name="searchBook" class="searchBookAcion">
		  <result name="success">/index.jsp</result>
		</action>
		
		<!-- 与用户登录注册相关的操作  -->
		<action name="user" class="userAction">
		  <result name="registerOk">/userManage/login.jsp</result>
		  <result name="nameAlreadyExist">/userManage/register.jsp</result>
		  <result name="loginOk">/userCenterService/userCenter.jsp</result>
		  <result name="notMatched">/userManage/login.jsp</result>
		</action>
		
		<!-- 用户中心 -->
		<action name="userCenter" class="userCenterAction">
		  <result name="userInfo">/userCenterService/userInfo.jsp</result>
		  <result name="updateOk">/userCenterService/userCenter.jsp</result>
		  <result name="releasedBooks">/userCenterService/releasedBooks.jsp</result>
		</action>
	</package>
	
    <!--  处理图片的动作类 -->
	<package name="image" extends="struts-default" namespace="/">
	
	  <action name="uploadImage"  class="uploadImageAction">
	    <param name="maximumSize">4194304</param>  <!-- 设置文件大小小于4M --> 
        <param name="allowedTypes">
          image/jepg,image/bmp,image/png,image/gif
        </param>
        <result name="success" type="redirect">/success.jsp</result>  
		<result name="input">/error.jsp</result>
	  </action>
	  
	  <!-- 根据Id查找图片,需要的变量：imageId -->
	  <action name="image" class="getImageAction">
	    <result name="notFound">/error.jsp</result>
	    <result >/success.jsp</result>
	  </action>
	</package>
	
	<!-- 测试使用的 test Action 在此注册 -->
	<package name="testAction" extends="struts-default" namespace="/test/">
		<!-- Interceptor监听器 的注册-->
		
		<!-- Action动作类的注册 -->
		<action name="fileUpload" class="test.UploadFileAction">
		  <result name="success">/success.jsp</result>
		  <result name="error">/error.jsp</result>
		</action>
	</package>
	
</struts>    
